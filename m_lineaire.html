<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title></title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/lumen.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.0.13/css/fa-svg-with-js.css" rel="stylesheet" />
<script src="site_libs/font-awesome-5.0.13/js/fontawesome-all.min.js"></script>
<script src="site_libs/font-awesome-5.0.13/js/fa-v4-shims.min.js"></script>
<link href="site_libs/ionicons-2.0.1/css/ionicons.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 54px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 59px;
  margin-top: -59px;
}

.section h2 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h3 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h4 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h5 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h6 {
  padding-top: 59px;
  margin-top: -59px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Tutoriel R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="map map-marker-alt"></span>
     
    Home
  </a>
</li>
<li>
  <a href="interface.html">
    <span class="ion ion-android-expand"></span>
     
    Demarrer
  </a>
</li>
<li>
  <a href="basicbuilding.html">0. Bases</a>
</li>
<li>
  <a href="importer.html">1. Importer</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    2. Modifier/Creer
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="g_variables.html">...des variables</a>
    </li>
    <li>
      <a href="g_bdd.html">...des bases de donnees</a>
    </li>
  </ul>
</li>
<li>
  <a href="v_quanti.html">3. Decrire</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    4. Analyser
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="compa_univ.html">Comparaisons bivariees</a>
    </li>
    <li>
      <a href="m_lineaire.html">Modele lineaire</a>
    </li>
    <li>
      <a href="m_rlog.html">Regression logistique</a>
    </li>
    <li>
      <a href="m_surv.html">Modele de survie</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="contact.html">
    <span class="fa fa-envelope-square fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<div id="modele-lineaire" class="section level2">
<h2>modele lineaire</h2>
<p>Dans cette section on s’interesse a la facon de specifier un modele lineaire dans R.</p>
<p>Un ensemble de vidéos expliquant simplement le concept des modeles lineaires peut etre trouve <a href="https://www.youtube.com/watch?v=PaFPbb66DxQ&amp;list=PLblh5JKOoLUIzaEkCLIUxQFjPIlapw8nU">ICI</a>.</p>
<p>On ne verra pas les etapes suivantes de validations et d’optimisation du modele. Des packages et fonctions interessantes pour cela peuvent etre trouvees <a href="https://www.statmethods.net/stats/regression.html">ICI</a>.</p>
<hr />
<p><strong>Creation d’une BDD</strong></p>
<p>Pour voir les etapes necessaires a la creation d’un modele on va construire un jeu de donnee basique.<br />
On pourra ainsi maitriser les parametres et definir les associations a trouver.</p>
<p>On definit BDD, une data frame de 450 observations de 6 variables continues normales.<br />
La variable d’interet est “var.1”&quot; que l’on cherche a expliquer par les 5 autres variables.</p>
<p>Par construction on connait la relation de var.1 avec les autres variables.</p>
<pre class="r"><code>#Variables

var.2&lt;- rnorm(450, 0, 12)
var.3&lt;- rnorm(450, 20, 24)
var.4&lt;- rnorm(450, 40, 36)
var.5&lt;- rnorm(450, 60, 48)
var.6&lt;- rnorm(450, 80, 60)

#Coefficients

A &lt;- 3
B &lt;- 1
C &lt;- 0.5
D &lt;- 0.2
E &lt;- 0

#On construit la variable d&#39;interet &quot;var.1&quot;, qui est la combinaison des variables precedemment crees, selon des coefficients determines, et un bruit blanc

var.1 &lt;- 48 + A*var.2 + B*var.3 + C*var.4 + D*var.5 + E*var.6 + rnorm(450, 0 , 17)  

#On structure la BDD

BDD &lt;- data.frame(var.1,var.2, var.3, var.4, var.5, var.6)
str(BDD)</code></pre>
<pre><code>## &#39;data.frame&#39;:    450 obs. of  6 variables:
##  $ var.1: num  163.6 100.6 62 140.2 15.2 ...
##  $ var.2: num  15.59 -14.661 0.138 -14.152 -10.047 ...
##  $ var.3: num  36.18 25.23 11.49 53.98 8.72 ...
##  $ var.4: num  23.8 59.3 24.3 43.5 -15.3 ...
##  $ var.5: num  144.93 79.93 7.82 127.91 44.34 ...
##  $ var.6: num  76.5 51.8 116.5 53.2 19.3 ...</code></pre>
<p><strong>Visualisation des associations brutes</strong></p>
<p>On peut visualiser dans un premiers temps la relation de notre variable d’interet avec les autres variables.<br />
On constate comme attendu que les relations semblent lineaires, et proches des coefficients specifies plus haut.</p>
<p><img src="m_lineaire_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
<div id="specification-dun-modele" class="section level1">
<h1>Specification d’un modele</h1>
<p>On specifie un 1er modele “M.Lineaire.1”, qui est le modele complet.<br />
Il modeleise la relation entre ‘var.1’ et l’ensemble des autres variables.<br />
La fonction summary() permet d’afficher les details de ce modele.</p>
<p>La sortie comporte plusieurs compartiments:</p>
<p><strong>Call:</strong> rappel de la formule utilisee.</p>
<p><strong>Residuals:</strong> propose une description de la distribution des residus, on s’y interessera plus tard pour examiner la concordance du modele avec les hypotheses du modele.</p>
<p><strong>Coefficients:</strong> affiche le coefficient, l’ecart type, la valeur t et la p-value pour l’intercept et chaques coefficients testes dans le modelee.</p>
<p>Le dernier compartiment indique plusieurs indicateurs notamment le R² et le R² ajuste.</p>
<pre class="r"><code>M.Lineaire.1 &lt;- lm(formula = var.1 ~ var.2 + var.3 + var.4 + var.5 + var.6, data= BDD)
summary(M.Lineaire.1)</code></pre>
<pre><code>## 
## Call:
## lm(formula = var.1 ~ var.2 + var.3 + var.4 + var.5 + var.6, data = BDD)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -49.139 -10.706  -0.549  11.159  62.236 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 48.973066   1.949150   25.12   &lt;2e-16 ***
## var.2        3.014095   0.068420   44.05   &lt;2e-16 ***
## var.3        1.036454   0.035528   29.17   &lt;2e-16 ***
## var.4        0.503681   0.022952   21.95   &lt;2e-16 ***
## var.5        0.190081   0.016869   11.27   &lt;2e-16 ***
## var.6       -0.004485   0.013188   -0.34    0.734    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 16.89 on 444 degrees of freedom
## Multiple R-squared:  0.8987, Adjusted R-squared:  0.8976 
## F-statistic:   788 on 5 and 444 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="comparaison-de-modeles" class="section level1">
<h1>Comparaison de modeles</h1>
<p>On peut comparer deux modeles a partir de la fonction anova(), a la condition qu’ils soient emboites.</p>
<p>On a cree le modele ‘M.lineaire.2’ qui comporte les meme variables que le modele precedent a l’exception de ‘var.2’, la variable la plus fortement associee a notre outcome.</p>
<p>La sortie affiche les modeles ainsi que la p-value associee a cette comparaison. On constatera qu’ils sont significativement differents.<br />
On conserve le modele 1 qui comporte le plus d’information.</p>
<pre class="r"><code>M.Lineaire.2 &lt;- lm(formula = var.1 ~ var.3 + var.4 + var.5 + var.6, data= BDD)

anova(M.Lineaire.1, M.Lineaire.2)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Model 1: var.1 ~ var.2 + var.3 + var.4 + var.5 + var.6
## Model 2: var.1 ~ var.3 + var.4 + var.5 + var.6
##   Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
## 1    444 126666                                  
## 2    445 680293 -1   -553627 1940.6 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="selection-des-variables" class="section level1">
<h1>Selection des variables</h1>
<p>Pour automatiser le processus precedent on peut s’aider de la fonction step(). Elle permet d’effectuer une selection purement statistique des variables a partir de la comparaison automatisee des modeles emboites.</p>
<p>La fonction part d’un modele initial a tester, ajoute/retire des variables et compare les modeles ainsi cree selon un critere que l’on definit. C’est un processus iteratif qui continue jusqu’a otpimiser notre critere de selection.</p>
<p>On doit specifier plusieurs choses:<br />
(1) le modele de depart<br />
(2) dans quelle direction la fonction doit elle chercher (forward: ajoute des variables ; backward: retire des variables ; both)<br />
(3) le domaine de recherche : c-a-d définir les modèles qui encadrent (le plus riche, le plus pauvre en information) l’ensemble des modèles que l’on souhaite explorer<br />
(4) le critere de selection (generalement AIC ou BIC).</p>
<p>On va specifier le modele null et le modele full qui sont respectivement le modele le plus pauvre en information que l’on souhaite tester et le modele le plus riche en information que l’on souhaite tester.<br />
Par defaut R ira du modele vide jusqu’au modele complet.<br />
Plusieurs options sont disponibles concernant la direction, on consultera la page d’aide pour plus de details.</p>
<p>La sortie de la fonction step est interessante a analyser.<br />
Les deux premiers lignes indique la valeur du critere ainsi que la formule pour le modele initial.</p>
<p>Le premier tableau indique les tests effectues.<br />
Le critere (ici le BIC malgre ce qu’affiche le tableau) est evalue dans plusieurs cas de figure:<br />
- en ajoutant var.2<br />
- en ajoutant var.3<br />
- en retirant var.6<br />
- en conservant le modele tel quel<br />
- en retirant var.5<br />
-en retirant var.4</p>
<p>Il en conclut que ce qui minimise le BIC est d’ajouter var.2.</p>
<p>Il ajoute var.2 a notre modele initial, et recommence la procedure.</p>
<p>Il continue ainsi jusqu’a obtenir un modele pour lequel ajouter/retirer une variable penalise notre critere.<br />
Il conserve ce modele en dernieres lignes et nous affiche ses coefficients.</p>
<pre class="r"><code>M.Lineaire.0 &lt;- lm(formula = var.1 ~ var.4 + var.5 + var.6, data= BDD)
null &lt;-lm(formula = var.1 ~ 1, data= BDD)
full&lt;- lm(formula = var.1 ~ var.2 + var.3 + var.4 + var.5 + var.6, data= BDD)

step(M.Lineaire.0, #le modele initial a tester
     direction = &quot;both&quot;, #regarde dans les deux directions, c&#39;est a dire vers les modeles plus complets mais aussi plus parcimonieux
     scope = list(lower=null,upper=full), #les modeles le plus pauvre/riche autorise
     criterion = &quot;BIC&quot;, #1er arugment sur le critere de selection
     k = log(nrow(BDD))) #2nd argument ; pour comparer en fonction de l&#39;AIC on retirera ces deux derniers arguments</code></pre>
<pre><code>## Start:  AIC=3523.13
## var.1 ~ var.4 + var.5 + var.6
## 
##         Df Sum of Sq     RSS    AIC
## + var.2  1    701563  369464 3050.3
## + var.3  1    390734  680293 3325.0
## - var.6  1      1134 1072161 3517.5
## &lt;none&gt;               1071027 3523.1
## - var.5  1     26918 1097945 3528.2
## - var.4  1    152226 1223254 3576.8
## 
## Step:  AIC=3050.3
## var.1 ~ var.4 + var.5 + var.6 + var.2
## 
##         Df Sum of Sq     RSS    AIC
## + var.3  1    242798  126666 2574.7
## - var.6  1        68  369532 3044.3
## &lt;none&gt;                369464 3050.3
## - var.5  1     36275  405739 3086.3
## - var.4  1    160554  530018 3206.6
## - var.2  1    701563 1071027 3523.1
## 
## Step:  AIC=2574.68
## var.1 ~ var.4 + var.5 + var.6 + var.2 + var.3
## 
##         Df Sum of Sq    RSS    AIC
## - var.6  1        33 126699 2568.7
## &lt;none&gt;               126666 2574.7
## - var.5  1     36221 162887 2681.7
## - var.4  1    137382 264048 2899.1
## - var.3  1    242798 369464 3050.3
## - var.2  1    553627 680293 3325.0
## 
## Step:  AIC=2568.69
## var.1 ~ var.4 + var.5 + var.2 + var.3
## 
##         Df Sum of Sq    RSS    AIC
## &lt;none&gt;               126699 2568.7
## + var.6  1        33 126666 2574.7
## - var.5  1     36223 162922 2675.7
## - var.4  1    137367 264066 2893.1
## - var.3  1    242833 369532 3044.3
## - var.2  1    554344 681043 3319.4</code></pre>
<pre><code>## 
## Call:
## lm(formula = var.1 ~ var.4 + var.5 + var.2 + var.3, data = BDD)
## 
## Coefficients:
## (Intercept)        var.4        var.5        var.2        var.3  
##     48.6206       0.5035       0.1901       3.0148       1.0365</code></pre>
</div>
<div id="verification-des-hypotheses" class="section level1">
<h1>Verification des hypotheses</h1>
<p>Une premiere etape succinte pour verifier les conditions d’application du modele est de verifier graphiquement la distribution des residus.<br />
On espere entre autre qu’ils suivent une loi normale de moyenne 0, qu’ils ne presentent pas de signe d’heteroscedascite, ou de points abherrants.</p>
<p>Notre jeu de donnees ayant ete construit de toute piece, on s’est premuni de ces situations.</p>
<pre class="r"><code>par(mfrow=c(2,2))
plot(lm(formula = var.1 ~ var.2 + var.3 + var.4 + var.5, data= BDD))</code></pre>
<p><img src="m_lineaire_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<hr />
<p>Pour s’entrainer.</p>
<p><strong>Synthese des fonctions</strong></p>
<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th>Fonction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>lm( outcome ~ variable1+ varible2, data= )</td>
<td>modele linaire</td>
</tr>
<tr class="even">
<td>anova(m1, m2)</td>
<td>comparaison des modeles m1 et m2</td>
</tr>
<tr class="odd">
<td>step(m1, direction= , scope(m.null , m.max))</td>
<td>selection stepwise des variables du modele m1</td>
</tr>
</tbody>
</table>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
