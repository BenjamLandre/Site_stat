<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title></title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/ionicons-2.0.1/css/ionicons.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Tutoriel R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="interface.html">
    <span class="ion ion-android-expand"></span>
     
    Demarrer
  </a>
</li>
<li>
  <a href="basicbuilding.html">0. Les bases</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    1. Les données
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="importer2.html">Formats</a>
    </li>
    <li>
      <a href="importer.html">Importer/Sauvegarder</a>
    </li>
    <li>
      <a href="g_variables.html">Modifier les données</a>
    </li>
  </ul>
</li>
<li>
  <a href="v_quanti.html">2. Decrire</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    3. Analyser
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="compa_univ.html">Comparaisons univariees</a>
    </li>
    <li>
      <a href="m_lineaire.html">Modele lineaire</a>
    </li>
    <li>
      <a href="m_rlog.html">Regression logistique</a>
    </li>
    <li>
      <a href="m_surv.html">Modele de survie</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<style>
hide {
  background-color: #d6d6d6;
  color: #d6d6d6;
}
hide:hover {
  background-color: white;
  color: black;
}
</style>
<style>
  h1{
    font-size: 25px !important;
    color: #FFFFFF !important;
    border-style: solid;
    border-color: #4582EC;
    background-color: #4582EC;
    text-align: center;
  }
</style>
<style>
  h2{
    font-size: 25px !important;
    color: #4582EC !important;
    border-style: solid;
    border-color: #4582EC;
    text-align: center;
  }
</style>
<style>
  h3{
    font-size: 25px !important;
    color: #FFFFFF !important;
    border-style: solid;
    border-color: #982727;
    background-color: #982727;
    text-align: center;
  }
</style>
<style>
  h4{
    font-size: 25px !important;
    color: #FFFFFF !important;
    border-style: solid;
    border-color: #0F9D58;
    background-color: #0F9D58;
    text-align: center;
  }
</style>
<style>
  h5{
    font-size: 25px !important;
    color: #FFFFFF !important;
    border-style: solid;
    border-color: #F4B400;
    background-color: #F4B400;
    text-align: center;
  }
</style>
<h4>
Synthèse
</h4>
<ul>
<li>Un modèle linéaire permet de décrire la relation entre une variable expliquée quantitative et une ou plusieurs variables explicatives.<br />
</li>
<li>La fonction lm() permet de paramètrer le modèle que l’on aura réfléchis au préalable.</li>
</ul>
<h1>
Principe du test
</h1>
<p>On cherche à expliquer les valeurs d’une variable (notée <strong>Y</strong>) en fonction d’une combinaison d’une (ou plusieurs) autre(s) variable(s) (notée <strong>X</strong>).</p>
<p>Quand on cherche à <em>comprendre</em> la relation entre variables on réfléchis généralement à partir d’une relation linéaire. Car elle est plus simple à interpréter. (“Pour l’augmentation d’une unité de X, de combien d’unité augmente X?”).</p>
<p>Cela revient à déterminer les paramètres de la droite qui passent au plus près de l’ensemble de points de coordonnées (X, Y). C’est la méthode des moindres carrés.</p>
<p><strong>Pour cela, il faut:</strong><br />
- déterminer l’ordonné à l’origine (noté <span class="math inline">\(\alpha\)</span>) et le coefficient de la pente de la droite (noté <span class="math inline">\(\beta\)</span>).<br />
- définir un critère pour évaluer la distance entre les points et la droite. C’est la somme des distances au carré (si elles n’étaient pas mise au carré les valeurs positives et négatives s’annuleraient).</p>
<p><em>Sur le graphique suivant, on teste différentes droites. On cherche la droite des “moindre carrée”, celle qui minimise les écarts entre la droite et les points (les distances en bleu). On cherche les paramètres (ordonné = triangle vert et pente = droite noire) qui font que la somme des distances en bleu soit la plus petite possible.</em></p>
<p><img src="Gif_ml.gif" /> <br><br></p>
<p>Parmi toutes les combinaisons possibles de <span class="math inline">\(\alpha\)</span> et <span class="math inline">\(\beta\)</span>, une seule permet d’obtenir la valeur la plus basse des moindres carrés, à partir de notre jeu de données.<br />
Sur la figure suivante, si on repère la valeur la plus basse de moindre carrés, on identifie le couple <span class="math inline">\(\alpha\)</span> et <span class="math inline">\(\beta\)</span> qui permettent de déteminer la droite optimale<a name="abcde"> </a>.</p>
<!-- <iframe src="https://plot.ly/~Benjamin_Landre/1/#/" -->
<!-- scrolling="no" -->
<!-- height=400 -->
<!-- width=500 -->
<!-- frameBorder="0"> -->
<!-- </iframe> -->
<iframe width="900" height="800" frameborder="0" scrolling="no" src="//plot.ly/~Benjamin_Landre/1.embed">
</iframe>
<h1>
Utilisation dans R
</h1>
<p>La solution directe à partir des fonctions dédiées est la méthode que l’on utilisera en pratique.<br />
La seconde méthode permet de voir et chercher à comprendre les calculs réalisés en arrière plan.</p>
<h2>
Solution directe
</h2>
<p>On définit une base de données et surtout une variable (Y), continue, à partir des autres variables (de 2 à 6).<br />
On souhaite retrouver l’intercept et les coefficients qui unissent la variable Y aux autre variables.<br />
On utilise un modèle linéaire (fonction lm()).</p>
<pre class="r"><code>## ##
# Définition de la base
## ##

#Variables
var.2&lt;- rnorm(450, 0, 12)
var.3&lt;- rnorm(450, 20, 24)
var.4&lt;- rnorm(450, 40, 36)
var.5&lt;- rnorm(450, 60, 48)
var.6&lt;- rnorm(450, 80, 60)

# Intercept
Inter &lt;- 48

# Coefficients
A &lt;- 3
B &lt;- 1
C &lt;- 0.5
D &lt;- 0.2
E &lt;- 0

# On construit &quot;Y&quot;, qui est la combinaison des variables précedente selon des coefficients déterminés
# l&#39;équation de la droite est la suivante:
Y &lt;- Inter + A*var.2 + B*var.3 + C*var.4 + D*var.5 + E*var.6 + rnorm(450, 0 , 17)  

# On crée la base
Base &lt;- data.frame(Y,var.2, var.3, var.4, var.5, var.6)</code></pre>
<pre class="r"><code>## ##
# Définition du modèle
## ##

M.Lineaire.1 &lt;- lm(formula = Y ~ var.2 + var.3 + var.4 + var.5 + var.6, data= Base)
summary(M.Lineaire.1) # synthèse des résultats
confint(M.Lineaire.1) # retourne les intervals de confiance</code></pre>
<p>Les résultats de la colonne ‘Estimate’ correspondent à l’estimation de l’intercept et coefficients de régression. On constate qu’ils sont proches de ceux utilisés pour la construction du jeu de données.</p>
<p>Les valeurs de p-values indiquent la probabilité d’observer cette estimation de coefficient si en réalité les observations étaient extraites d’une population où ce coefficient est nul (hypothèse nulle = le coefficient est nul).<br />
Comme précédemment, plus cette probabilité est faible, plus il est difficile de croire que l’hypothèse nulle soit valide.</p>
<p>La partie ‘Residuals’ indique les statistiques des résidus. Les résidus représentent, pour chaque individu, l’écart entre la valeur observée de Y et celle que l’on prédit par le modèle.<br />
Plusieurs éléments de validités du modèle sont à déterminer à partir des résidus <a href="#habibi">(voir ici)</a>.</p>
<div class="figure">
<img src="sortielm.png" />

</div>
<h2>
Step by step
</h2>
<pre class="r"><code># On sépare les X du Y
Mon_Y &lt;- as.matrix(Base[ , 1])
Mes_x &lt;- as.matrix(Base[ , 2:6])

# On ajoute une colonne permettant le calcul de l&#39;ordonné à l&#39;origine de la droite
Mes_x_et_intercept = cbind(Mes_x,1)

# On calcul les coefficients
Mes_coefficients &lt;- solve(t(Mes_x_et_intercept) %*% Mes_x_et_intercept) %*% t(Mes_x_et_intercept) %*% Mon_Y
Mes_coefficients</code></pre>
<pre><code>##               [,1]
## var.2  3.015072195
## var.3  1.077250474
## var.4  0.473605540
## var.5  0.167852229
## var.6 -0.006491427
##       49.863751474</code></pre>
<p><details> <summary>Clique ICI pour le détail du calcul</summary></p>
<p>On détail le cacul à partir d’un jeu de données plus petit pour simplifier le calcul numérique.</p>
<p>Ce calcul comporte plusieurs étapes qui font intervenir des calculs entre matrices.<br />
On pourra trouver des rappels (ou non) de ces calculs <a href="https://www.mathsisfun.com/algebra/matrix-introduction.html">ICI</a> et en particulier concernant <a href="https://www.mathsisfun.com/algebra/matrix-inverse.html">l’inversion d’une matrice</a>.</p>
<p>On a généré des données à partir du code suivant:<br />
<br> <strong>X &lt;- rnorm(5)<br />
Y &lt;- 10 + 3 * X + rnorm(5, 0, 0.2)</strong><br />
<br></p>
<p>On obtient 5 valeurs de X (0.75, -0.53; -1.26, -0.73 et 2.05).<br />
Elles permettent de déterminer 5 valeurs de Y (12.1, 8.38, 6.11, 7.74, 16.33) à partir d’un intercept <span class="math inline">\(\alpha\)</span> (10), d’un coefficient <span class="math inline">\(\beta\)</span> (3). On observe une erreur d’estimation aléatoire, u, de distribution normale.</p>
<p>On peut représenter cette équation sous la forme suivante:</p>
<p><img src="equation1.png" /> <br><br> Généralement on dispose de X et de Y et on aimerait déterminer <span class="math inline">\(\alpha\)</span> et <span class="math inline">\(\beta\)</span> qui sont inconnus.<br />
On peut réécrire l’équation comme suit:</p>
<p><img src="equation2.png" /> <br> <strong>Détermination des coefficients:</strong><br />
On peut obtenir une estimation d’<span class="math inline">\(\alpha\)</span> et <span class="math inline">\(\beta\)</span> à partir de l’équation suivante:<br />
<img src="La_0.png" alt="Les différentes étapes" /></p>
<p><strong>Etape 1</strong></p>
<p>Cette première étape multiple la <a href="https://www.mathsisfun.com/algebra/matrix-introduction.html">transposé</a> de X, avec X.<br />
On obtient une matrice carrée de 2 lignes 2 colonnes.</p>
<p><img src="La_1.png" /> <br> <strong>Etape 2</strong></p>
<p>Au cours de la seconde étape on <a href="https://www.mathsisfun.com/algebra/matrix-inverse.html">inverse</a> la matrice obtenue précédemment.<br />
On obtient de nouveau une matrice carré à 2 lignes et 2 colonnes.</p>
<p><img src="La_2.png" /> <br> <strong>Etape 3</strong></p>
<p>L’étape 3 s’intéresse au membre de droite de l’équation générale. On multiplie la transposée de X avec la matrice Y.<br />
On obtient une matrice de 1 colonne et 2 lignes.</p>
<p><img src="La_3.png" /> <br> <strong>Etape 4</strong></p>
<p>Cette dernière étape est le résultat générale de l’équation.<br />
On multiplie les matrices obtenues à l’étape <strong>(2)</strong> et à l’étape <strong>(3)</strong>.<br />
On obtient une matrice de 1 colonne et 2 lignes.</p>
<p>La premère ligne donne l’estimation du coefficient <span class="math inline">\(\beta\)</span>, la seconde ligne l’estimation de l’intercept <span class="math inline">\(\alpha\)</span>.</p>
<p><img src="La_4.png" /> <br> <strong>Synthèse</strong></p>
<p>A partir de 5 observations et de plusieurs étapes de calculs matriciels, on a déterminé des estimations de <span class="math inline">\(\alpha\)</span> et <span class="math inline">\(\beta\)</span>. Ces estimations sont proches des valeurs utilisées pour générer les données (10 et 3, respectivement).</p>
<p></details></p>
<h1>
Conditions de validité
</h1>
<p><a name="habibi"> </a> <strong>En réalisant ce type de modèle on suppose que:</strong><br />
<strong>(1)</strong> il existe une relation linéaire entre les variables.<br />
<strong>(2)</strong> l’erreure aléatoire entre estimation et la valeur réelle de Y suit une loi normale de moyenne 0.<br />
<strong>(3)</strong> l’erreure aléatoire entre […] est similaire quelque soient les valeurs des <strong>Y</strong>(s).</p>
<p>Le point <strong>(1)</strong> se vérifie au préalable du modèle, en explorant les distribution entre Y et les variables <strong>X</strong>(s) que l’on souhaite utiliser dans le modèle.<br />
Les points <strong>(2)</strong> &amp; <strong>(3)</strong> sont à vérifier après avoir calculer le modèle et <strong>avant</strong> de se lancer dans l’interprétation des coefficients.</p>
<p>Une solution courante est de vérifier graphiquement la distribution des <strong>résidus</strong> (la différence entre valeurs prédites et valeurs observées).</p>
<pre class="r"><code>M.Lineaire.1 &lt;- lm(formula = Y ~ var.2 + var.3 + var.4 + var.5 + var.6, data= Base)
plot(M.Lineaire.1)</code></pre>
<p>On obtient 4 graphiques de synthèse du modèle, on interprétera les 2 premiers pour analyser les résidus.</p>
<p>Le premier graphique représente la valeur des résidus selon la valeur des Y prédits.<br />
Il informe sur <strong>(2)</strong> la moyenne des erreures et <strong>(3) l’homoscédasticité</strong> (= les erreurs que l’on commet sont régulière selon les valeurs de Y).</p>
<p><img src="lm_1.png" /> <br><br> <strong>On souhaite que:</strong><br />
- la droite rouge soit constamment proche de 0. <strong>(2)</strong><br />
- le nuage de point est quelconque, il n’a surtout pas une forme de cône. <strong>(3)</strong></p>
<hr />
<p>Le second graphique compare la distribution <em>observée</em> des résidus avec la distribution <em>théorique</em> des résidus <strong>SI</strong> ils suivaient une loi normale.</p>
<p><img src="lm_2.png" /> <br><br> <strong>On souhaite que:</strong><br />
- les points soient le plus possible alignés le long de la diagonale. (on est moins sévère sur les extrémités)<br />
- on ne veut pas déviation trop prononcée et systèmatique de cette droite.</p>
<hr />
<p>Le dernier graphique de la synthèse du modèle permet d’observer les <em>valeurs influentes</em> du modèle.<br />
Ce graphique permet d’identifier les individus dont les valeurs prennent beaucoup d’importance dans la détermination des coefficients du modèle.</p>
<p>Parmi ces individus, il y a potentiellement des individus dont les valeurs sont abherrantes / fausses ou qui ont des caractéristiques qui sont réellement trop différentes du reste des individus.<br />
Cela peut grandement fausser les estimations du modèle car décrit alors une droite qui passe à mi chemin entre un groupe de point homogène et un point très “lointain”. Les coefficients ne décrivent alors ni le nuage de point ni le point éloigné.</p>
<p>Sur le graphique les numéros de ligne des individus influants sont affichés, cela peut être utile pour analyser en détail leurs caractéristiques.</p>
<div class="figure">
<img src="lm_3.png" />

</div>
<h1>
Relation entre variables
</h1>
<p>Quand on fait une analyse multivariée, on considère que Y peut être expliqué par au moins deux variables. Il faut alors réfléchir et définir le type de relation que l’on souhaite exprimer.</p>
<p>On se concentre sur l’association entre Y et var.2 en fonction des valeurs prisent par var.3.<br />
On compare les différentes façon de prendre en compte cette variable.</p>
<p>On illustrera 3 situations (ajustement, interaction et stratification) à partir des données définies dans le code suivant.</p>
<pre class="r"><code>## ##
# La base utilisée
## ##

# 3 Variables explicatives : nos X
# var.2 et var.4 sont continues
# var.3 est une variable catégorielle
var.2 &lt;- rnorm(450, 0, 12)
var.3 &lt;- c(rep(&quot;A&quot;, 450/2), rep(&quot;B&quot;, 450/2))

# Intercept
Inter1 &lt;- 48 # Intercept bas
Inter2 &lt;- 60 # Intercept élevé

# Coefficients
Coef1 &lt;- 1 # coefficient +
Coef2 &lt;- -1 # coefficient -</code></pre>
<h2>
L’ajustement
</h2>
<p>On imagine que la relation entre Y et var.2 est identique dans les deux catégories de var.3 par contre les niveaux moyens de Y dépendent des catégories de var.3.</p>
<p>On modèlise cela par des droites parallèles (<span class="math inline">\(\beta\)</span> identiques entre les groupes), dont les ordonnés à l’origine différent (<span class="math inline">\(\alpha\)</span> différents entre les groupes).</p>
<pre class="r"><code># Ceux de la catégorie A on un intercept bas: Inter1
# Ceux de la catégorie B on un intercept élevé: Inter2
Y &lt;- ifelse(var.3 == &quot;A&quot;, Inter1 + Coef1*var.2 + rnorm(450/2, 0, 18), 
                              Inter2 + Coef1*var.2 + rnorm(450/2, 0, 18))


# Si on n&#39;ajuste pas
# on définit un seul intercept et une seule pente
# quelque soit la valeur de var.3 on a une seule valeur d&#39;intercept et de pente pour expliquer le lien entre Y et var.2
Resu &lt;- lm(Y ~ var.2)
Resu$coefficients</code></pre>
<pre><code>## (Intercept)       var.2 
##   54.939486    1.027175</code></pre>
<pre class="r"><code># Représentation graphique
plot(var.2, Y)
abline(Resu$coefficients[[1]], Resu$coefficients[[2]], lwd= 5, lty = &quot;dotted&quot;)</code></pre>
<div class="figure">
<img src="Rplot11.png" />

</div>
<pre class="r"><code># Si on ajuste
# on définit une seule pente &#39;var.2&#39; mais 2 intercepts
# 1 = l&#39;intercept pour le groupe A de reference &#39;(Intercept)&#39;
# 2 = une valeur pour ceux du groupe B &#39;var.3B&#39;, 
# c&#39;est la différence entre l&#39;intercept du groupe A et celle du groupe B
# On calcul l&#39;intercept du groupe B en ajoutant &#39;(Intercept)&#39; et &#39;var.3B&#39;
Resu &lt;- lm(Y ~ var.2+var.3)
Resu$coefficients</code></pre>
<pre><code>## (Intercept)       var.2      var.3B 
##   49.854391    1.029107   10.170611</code></pre>
<pre class="r"><code># Représentation graphique
plot(var.2, Y, col=c(&quot;blue&quot;, &quot;tomato&quot;)[as.numeric(as.factor(var.3))], pch = 16)
abline(Resu$coefficients[[1]], Resu$coefficients[[2]], lwd= 5, lty = &quot;dotted&quot;)
abline(Resu$coefficients[[1]]+Resu$coefficients[[3]], Resu$coefficients[[2]], lwd= 5, lty = &quot;dotted&quot;)</code></pre>
<div class="figure">
<img src="Rplot10.png" />

</div>
<h2>
L’intéraction
</h2>
<p>On imagine que la relation entre Y et var.2 dépend des catégories de var.3 aussi bien pour la pente que pour l’intercept.</p>
<p>Pentes et intercepts sont différents entre les droites.</p>
<pre class="r"><code># Ceux du groupe A on un coefficient positif Coef1
# Ceux du groupe B on un coefficient negatif Coef2
Y &lt;- ifelse(var.3 == &quot;A&quot;, Inter1 + Coef1*var.2 + rnorm(450/2, 0, 18), 
                              Inter1 + Coef2*var.2+ rnorm(450/2, 0, 18))

# / ! \ dans l&#39;exemple les intercepts sont identiques, ils pourraient être différents


# Si on ne prend pas en compte l&#39;intéraction
# on pense que la pente est proche de 0, ce qui est faux pour les deux groupes.
Resu &lt;- lm(Y ~ var.2)
Resu$coefficients</code></pre>
<pre><code>## (Intercept)       var.2 
## 47.84733399 -0.06332559</code></pre>
<pre class="r"><code># Représentation graphique
plot(var.2, Y)
abline(Resu$coefficients[[1]], Resu$coefficients[[2]], lwd= 5, lty = &quot;dotted&quot;)</code></pre>
<div class="figure">
<img src="Rplot09.png" />

</div>
<pre class="r"><code># Si on prend en compte l&#39;intéraction
# on définit un coefficient pour le groupe A &#39;var.2&#39;
# on définit une valeur pour le groupe B &#39;var.2:var.3B&#39;, que l&#39;on ajoute au coefficient du groupe A:
# c&#39;est la différence entre les pente du groupe A et du groupe B.
Resu &lt;- lm(Y ~ var.2*var.3)
Resu$coefficients</code></pre>
<pre><code>##  (Intercept)        var.2       var.3B var.2:var.3B 
##   47.5638333    1.0014915    0.4783754   -1.9961580</code></pre>
<pre class="r"><code># Représentation graphique
plot(var.2, Y, col=c(&quot;blue&quot;, &quot;tomato&quot;)[as.numeric(as.factor(var.3))], pch = 16)
abline(Resu$coefficients[[1]], Resu$coefficients[[2]], lwd= 5, lty = &quot;dotted&quot;)
abline(Resu$coefficients[[1]]+Resu$coefficients[[3]], Resu$coefficients[[2]]+Resu$coefficients[[4]], lwd= 5, lty = &quot;dotted&quot;)</code></pre>
<div class="figure">
<img src="Rplot08.png" />

</div>
<h2>
La stratification
</h2>
<p>Si on se rend compte les relations entre Y et plusieurs variables explicative sont différentes selon le groupe d’appartenance (var.3), on peut considérer que ces deux groupes ne peuvent pas être expliquée par un seul modèle.<br />
On conduit alors des analyses séparemment dans chacun des groupes, c’est une <strong>stratification</strong>.</p>
<h1>
Comparaison de modèles
</h1>
<p>La définition des modèles reposent sur des choix de variable.<br />
Ces choix sont en partie guidé par la littérature sur le sujet et le contexte de l’étude.<br />
Ils peuvent également être appuyés par une analyse statistique.</p>
<p>On a vu <a href="#abcde">plus haut</a> qu’il existe une combinaison optimale de coefficient qui permettent d’obtenir <strong>LA</strong> droite qui correspond aux moindre carrés.<br />
Cependant, toutes les variables ne participents pas également à la modèlisation de <strong>Y</strong>.<br />
Quand une variable participe très faiblement, on peut se demander si le moindre carré obtenus à partir d’un modèle sans cette variable est éloigné du moindre carré obtenu dans le modèle avec la variable.</p>
<p>On calcul la distance entre les deux valeurs de moindre carré obtenus dans chacun des modèle.<br />
On les compare à partir d’un test statistique, en prenant en compte la différence du nombre de variable entre modèles.<br />
La p-value obtenue indique la probabilité d’observer cette différence si en réalité ces deux modèles sont équivalents. Plus cette probabilité est faible plus on a du mal à croire que ces modèles soient similaires.<br />
Dans ce cas on conserve toujours le modèle présentant le plus grand nombre de variable car il présente <strong>obligatoirement</strong> plus d’information que le modèle plus pauvre.</p>
<p><strong>Pour être valide cette comparaison doit avoir lieu sur des échantillons identiques et dans des modèles emboîtés.</strong></p>
<p><em>Dans R:</em></p>
<pre class="r"><code>M.Lineaire.1 &lt;- lm(formula = Y ~ var.2 + var.3 + var.4 + var.5 + var.6, data= Base)
M.Lineaire.2 &lt;- lm(formula = Y ~ var.2 + var.3 + var.4, data= Base)

anova(M.Lineaire.1, M.Lineaire.2)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Model 1: Y ~ var.2 + var.3 + var.4 + var.5 + var.6
## Model 2: Y ~ var.2 + var.3 + var.4
##   Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
## 1    444 134792                                  
## 2    446 162527 -2    -27735 45.679 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<h5>
Fonctions sur cette page
</h5>
<table style="width:100%;">
<colgroup>
<col width="30%" />
<col width="69%" />
</colgroup>
<thead>
<tr class="header">
<th>Fonction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>lm(formula =, data = )</td>
<td>renvoi les résultats d’un modèle linéaire</td>
</tr>
<tr class="even">
<td>confint(model)</td>
<td>renvoi les intervals de confiance à 95% du modèle linéaire ‘model’</td>
</tr>
<tr class="odd">
<td>anova(model1, model2)</td>
<td>renvoi la comparaison des moindres carrés des models 1 &amp; 2</td>
</tr>
</tbody>
</table>
<h3>
Pour s’entraîner
</h3>
<p>A venir, un jours.</p>

&nbsp;
<hr />
<p style="text-align: center;"><span style="color: #808080;"><em>benjamin.landre@inserm.fr</em></span></p>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://twitter.com/benjamin_landre" class="fa fa-twitter"></a>
    <a href="https://fr.linkedin.com/in/benjamin-landr%C3%A9-922b1b153" class="fa fa-linkedin"></a>
    <a href="https://github.com/benjamlandre" class="fa fa-github"></a>
</p>

&nbsp;


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
